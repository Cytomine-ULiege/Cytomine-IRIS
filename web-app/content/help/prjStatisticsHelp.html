<div>
    <h4>Project Statistics Dashboard</h4>
    The project statistics dashboard is divided into tabs, which allow different views on the annotations.
    <ul>
        <li><b>User Statistics</b>: lets you combine various filters and view the histogram of assigned labels for
            one or more users.
        </li>
        <li><b>Annotation Agreements</b>: lets you combine various filters and view inter-observer agreement on the annotations.
        </li>
    </ul>
    In both cases, a filter panel as shown below allows you to construct your query.
    <div class="row">
        <div class="col-sm-4 text-center">
            <b>User Filter</b>
            <br>
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-filterpanel-1.png"/>
        </div>
        <div class="col-sm-4 text-center">
            <b>Ontology Filter</b>
            <br>
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-filterpanel-2.png"/>
        </div>
        <div class="col-sm-4 text-center">
            <b>Image Filter</b>
            <br>
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-filterpanel-3.png"/>
        </div>
    </div>
    <div>
        <h5>Well, I don't see the filter!?</h5>
        <p>
            The filter panel can be hidden by selecting the <span class="glyphicon glyphicon-chevron-left"></span> icon
            or clicking the gray bar on the left side of the window.
            Similarly, the panel can be shown by selecting the <span class="glyphicon glyphicon-chevron-right"></span> icon
            or clicking the gray bar on the left side of the window.
        </p>
    </div>


    <hr>
    <h4>User Statistics</h4>
    User statistics allow a complete picture of all terms assigned by one or more particular users.
    Select users from the left hand side you want to examine, choose one or more terms or images and then select
    <span class="btn btn-primary"><span class="glyphicon glyphicon-refresh"></span> Refresh</span> in the main view.
    <br>
    You can also hide the filter panel by clicking on the <span class="glyphicon glyphicon-chevron-left"></span> icon
    or the grey bar at the left border of the window.

    <div class="text-center" style="margin-top:20px;">
        <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-user-histogram.png"/>
    </div>
    <div class="row">
        <div class="col-sm-8">
            For each user there will be one histogram and two progress bars.
            The histogram contains the filtered labels and hovering the bars in the chart indicates the frequency of that term
            for the user.
            <ol type="a">
                <li>The name of the user</li>
                <li>Total number of annotations labeled by the user</li>
                <li>Total number of annotations with one or more labels</li>
                <li>Total number of annotations (also includes annotations without labels)</li>
            </ol>
            The first progress bar indicates the progress relative to the observer who labeled most annotations of all users,
            which is the total number of annotations by the user divided by all annotations with labels.
            So example, if the first progressbar is at 100%, this means that this particular user has assigned most of all terms.
            <br>
            The second progress bar indicates the overall progress: total number of labeled annotations by the user divided by all annotations.
        </div>
        <div class="col-sm-4">
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-user-description.png"/>
        </div>
    </div>



    <hr>
    <div>
        <h4>Annotation Agreements</h4>
        The agreements among particular users can be viewed by selecting this tab.
        Similar to the user statistics, you can construct a query by using the filter panels shown on the left hand side.
        Also, this panel can be hidden by clicking on the <span class="glyphicon glyphicon-chevron-left"></span> if more
        space for displaying the annotations is required.
        <br>
        <div class="row text-center">
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-overview-lvl-0_1_web.png"/>
        </div>
        Once the filter is constructed and you hit
        <button type="button" class="btn btn-primary"><span class="glyphicon glyphicon-refresh"></span> Refresh</button>,
        a list of all eligible annotations will be shown.
        <p>
            In the top right corner of the list, you will see the total number of annotations in the query as well as the annotations
            shown on the current page.
            Navigate through the pages using the pagination controls at the bottom left of the table, or change the total number
            of items displayed on one page by clicking a number at the bottom right of the table.
        </p>
        <p>
            In this list, the first column shows a preview of the annotation, which can be enlarged by clicking on the thumbnail.
        </p>
        <p>
            The second column contains one bar chart for each individual term that was assigned by any of the users.
            The bars are sorted primarily by their agreement and secondarily by their term name.
            Below the bar chart, the name of the term is displayed and the percentage of users in this query that assigned the term.
            In brackets, the total number of users assigning this term is displayed.
            In addition to that, an orange <span class="glyphicon glyphicon-warning-sign" style="color:orangered;"></span> icon may indicate
            that a particular term has been assigned by one user only and that the agreement on this term may be invalid.
            Let the mouse rest on the icon and additional information will be displayed.
        </p>
        <p>
            The subsequent columns contain the users' assignments, alphabetically ordered ascending that lead to the statistics
            visualized as horizontal bar chart in the second column.
        </p>


        <br>
        <h5>Filtering Agreement Levels</h5>
        Usually the agreement is not filtered (0%) and thus, all annotations are shown in the list.
        Agreement can be filtered using the slider control at the top of the annotation list.
        <div class="row">
            <div class="col-sm-6 text-center">
                <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-slider-0.png"/>
                <br>
                <b>Slider in leftmost position, no agreement filtering.</b>
            </div>
            <div class="col-sm-6 text-center">
                <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-slider-2.png"/>
                <br>
                <b>Slider in position 2, agreement filtering for 2 or more users agreeing on a term.</b>
            </div>
        </div>
        <div>
            As the slider is moved to the right, the list usually becomes shorter but the confidence on the selected terms
            increases.
            For instance, if you move the slider to the rightmost position, you will only get agreements, where all users in your
            query agreed.

            <div class="row text-center">
                <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-overview-lvl-2+_1_web.png"/>
            </div>
        </div>
    </div>

    <hr>
    <div>
        <h4>Export Image Dataset</h4>
        Images from the database can be exported to your local hard drive according to a variety of settings.
        Basis for the export is the annotation agreement list, which may optionally be filtered.
        At the bottom of the page, you will find options for the image dataset export: <span class="glyphicon glyphicon-export"></span>&nbsp;<strong>Export Options</strong>.
        <br>
        <div class="row text-center">
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-0.png"/>
        </div>
        Selecting <button type="button" class="btn btn-xs btn-info">Export Image Dataset...</button> brings up the export dialog with the export options.
        Hints regarding the options are given in grey italic font.

        <div class="row text-center">
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-1.png"/>
        </div>

        <h5>Dataset Scope</h5>
        <ul>
            <li><b>all</b> annotations: exports all annotations across all pages in this query, ignores the agreement filter</li>
            <li><b>filtered</b> annotations: exports only filtered annotations across all pages</li>
            <li><b>current</b> page: exports only annotations on the current page, considers the agreement filter</li>
            <li><b>pages</b>: exports annotations from the specified pages (starting at 1), considers the agreement filter, you may use ranges using a dash like 1-10 or only specific pages using 1;3;8-10.
                The number of items per page is determined by the table settings (i.e. 10, 25, 50, 100).</li>
        </ul>

        <h5>Image Export Settings</h5>
        <ul>
            <li><b>minimum bounding box</b>: each annotation has a minimum bounding box according to its shape.
                This option exports a rectangular portion of the image, which just contains the user- or algorithm-defined annotation.
                <div class="row text-center">
                    <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-image-0_minBB.png"/>
                </div>
            </li>
            <li><b>fixed window</b>: for each annotation, the centroid information is used as center point and a window with fixed non-negative dimensions defined by width and height.
                <div class="row text-center">
                    <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-image-0_fixed.png"/>
                </div>
            </li>
            <li><b>dynamic window</b>: similar to the minimum bounding box approach, this option grows the minimum bounding box extent by a specific border size.
                <div class="row text-center">
                    <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-image-0_dynamic.png"/>
                </div>
            </li>
        </ul>

        <h5>Image Resolutions</h5>
        <div class="row">
            <div class="col-sm-6">
                Since most of the images are stored as pyramids, different resolutions can be exported for each annotation.
                <ul>
                    <li><b>image resolutions</b>: starting at 0 being the maximum resolution (e.g. 40x),
                        you may use resolution ranges using a dash like 1-10 or only specific pages using 1;3;8-10.
                        If a resolution does not exist for an image, this export will be skipped.
                </ul>
            </div>
            <div class="col-sm-6 text-center">
                <a href="https://en.wikipedia.org/wiki/Pyramid_(image_processing)#/media/File:Image_pyramid.svg" target="_blank">
                    <img class="img-rounded dropshadowimg" alt="image taken from https://en.wikipedia.org/wiki/Pyramid_(image_processing)#/media/File:Image_pyramid.svg" src="images/help/image-pyramid.png"/>
                </a>
            </div>
        </div>


        <h5>Export Format</h5>
        Once the export parameters are determined, click on the button <button class="btn btn-primary" ng-style="{ 'text-align': 'center' }">Export</button>.
        This will trigger a dataset creation request at the server and the dataset is collected.
        Depending your request and project, this may take a while.
        Once the dataset is complete, your browser should automatically prompt you to store the ZIP file.
        The <b>generated link is a permanent link to your dataset</b>, you may store it separately to have access to this file in the future using the 'copy link' function in your browser.
        <div class="row text-center">
            <img class="img-rounded dropshadowimg" alt="" src="images/help/stats-agreement-export-3.png"/>
        </div>

        For more details regarding the ZIP file structure, you are kindly referred to the
        <a href="https://github.com/cytomine/Cytomine-IRIS/wiki/Statistics-Dashboard#export-format" target="_blank">Cytomine IRIS wiki pages</a>.

    </div>

    <hr>
    <h4>Keyboard Shortcut List</h4>
    <p>
        Open the list of keyboard shortcuts available for this page by pressing <span class="cfp-hotkeys-key">?</span> on your keyboard.
    </p>
</div>